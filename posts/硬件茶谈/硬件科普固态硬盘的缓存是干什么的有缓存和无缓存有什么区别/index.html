<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=theme-color content="dark"><title>【硬件科普】固态硬盘的缓存是干什么的？有缓存和无缓存有什么区别？ | QGAYE's Blog</title><meta property="og:site_name" content><meta property="og:title" content="【硬件科普】固态硬盘的缓存是干什么的？有缓存和无缓存有什么区别？ | QGAYE's Blog"><meta itemprop=name content="【硬件科普】固态硬盘的缓存是干什么的？有缓存和无缓存有什么区别？ | QGAYE's Blog"><meta name=twitter:title content="【硬件科普】固态硬盘的缓存是干什么的？有缓存和无缓存有什么区别？ | QGAYE's Blog"><meta name=application-name content="【硬件科普】固态硬盘的缓存是干什么的？有缓存和无缓存有什么区别？ | QGAYE's Blog"><meta name=twitter:card content="summary"><meta name=description content><meta name=twitter:description content><meta itemprop=description content><meta property="og:description" content><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=stylesheet href=/sass/main.min.ab99ff095f832511e24ffb2fba2b51ad473b2f7e9301d674eba2c6c3a6e8bd81.css></head><script>(function(){const a='ThemeColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='ThemeColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.userColorScheme='dark':document.documentElement.dataset.userColorScheme='light'})()</script><body class=dark><nav class=navbar><div class=container><div class=flex><div><a class=brand href=/>QGAYE's Blog</a></div><div class=flex><a href=/tags/>Tags</a>
<a href=/about/>About</a>
<button id=dark-mode-button><svg class="light" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)" viewBox="0 0 36 36"><path fill="#ffd983" d="M30.312.776C32 19 20 32 .776 30.312c8.199 7.717 21.091 7.588 29.107-.429C37.9 21.867 38.03 8.975 30.312.776z"/><path d="M30.705 15.915a1.163 1.163.0 101.643 1.641 1.163 1.163.0 00-1.643-1.641zm-16.022 14.38a1.74 1.74.0 000 2.465 1.742 1.742.0 100-2.465zm13.968-2.147a2.904 2.904.0 01-4.108.0 2.902 2.902.0 010-4.107 2.902 2.902.0 014.108.0 2.902 2.902.0 010 4.107z" fill="#ffcc4d"/><rect x="0" y="0" width="36" height="36" fill="rgba(0, 0, 0, 0)"/></svg><svg class="dark" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform:rotate(360deg);-webkit-transform:rotate(360deg);transform:rotate(360deg)" viewBox="0 0 36 36"><path fill="#ffd983" d="M16 2s0-2 2-2 2 2 2 2v2s0 2-2 2-2-2-2-2V2zm18 14s2 0 2 2-2 2-2 2h-2s-2 0-2-2 2-2 2-2h2zM4 16s2 0 2 2-2 2-2 2H2s-2 0-2-2 2-2 2-2h2zm5.121-8.707s1.414 1.414.0 2.828-2.828.0-2.828.0L4.878 8.708s-1.414-1.414.0-2.829c1.415-1.414 2.829.0 2.829.0l1.414 1.414zm21 21s1.414 1.414.0 2.828-2.828.0-2.828.0l-1.414-1.414s-1.414-1.414.0-2.828 2.828.0 2.828.0l1.414 1.414zm-.413-18.172s-1.414 1.414-2.828.0.0-2.828.0-2.828l1.414-1.414s1.414-1.414 2.828.0.0 2.828.0 2.828l-1.414 1.414zm-21 21s-1.414 1.414-2.828.0.0-2.828.0-2.828l1.414-1.414s1.414-1.414 2.828.0.0 2.828.0 2.828l-1.414 1.414zM16 32s0-2 2-2 2 2 2 2v2s0 2-2 2-2-2-2-2v-2z"/><circle fill="#ffd983" cx="18" cy="18" r="10"/><rect x="0" y="0" width="36" height="36" fill="rgba(0, 0, 0, 0)"/></svg></button></div></div></div></nav><main><div class=container><article><header class=article-header><div class=thumb><div><h1>【硬件科普】固态硬盘的缓存是干什么的？有缓存和无缓存有什么区别？</h1><div class=post-meta><div>By | <time>June 04, 2022</time>
| 1 minutes</div><div class=tags><a href=/tags/%E7%A1%AC%E4%BB%B6%E7%A7%91%E6%99%AE/>硬件科普</a></div></div></div></div></header></article><div class=article-post><p><a href="https://www.youtube.com/watch?v=7ZJ4UFxaAZw">【硬件科普】固态硬盘的缓存是干什么的？有缓存和无缓存有什么区别？</a></p><p>固态硬盘主要结构：主控芯片、DRAM缓存、NAND闪存</p><p>固态硬盘写入数据时，数据经过 主控处理随后被放在NAND闪存颗粒中，读取数据时，主控会从FTL表中找到数据位置，然后从NAND颗粒中找到数据，之后通过M.2接口和PCIe总线发送给计算机其他配件</p><p>逻辑物理映射表（FTL表）：主控在写入时记录写入的NAND颗粒的具体位置（哪个晶片、哪个区、哪个块、哪个页），下次数据读取时通过FTL表找到数据的具体存储位置进行数据读取，一般来说1G容量的NAND颗粒需要1MB的FTL表缓存</p><p>FTL表存放位置：</p><ul><li>DRAM足够大时，可以全部存放在DRAM中</li><li>厂家为了节省成本，DRAM不够时（或者直接较小缓存集成在主控中），就会将常用文件的FTL表放在DRAM中，剩余的放在NAND颗粒中</li><li>无缓存方案，采用HMB技术，在启动时将一部分FTL表加载到内存中，通过PCIe高速通道来达到加速读取的功能</li></ul><p>NAND颗粒由多层晶片（die chip）构成，每个die chip有两个区plane，它们共用一个地址解码器，每个区plane中由大量Block块组成</p><p>浮栅晶体管，其是可以存储电子的结构，因此也就是可以用来存储数据</p><p>SLC颗粒：每个浮栅晶体管只能存放1Bit数据，当浮栅晶体管中电子数大于3时认定为1，小于3时认定为0
MLC颗粒：每个浮栅晶体管可以存储2Bit数据，即根据浮栅晶体管中电子数量区间判定是00、01、10、11
TLC颗粒：每个浮栅晶体管可以存储3Bit数据，浮栅晶体管中每个数量的电子都对应一个数据，因此对电压的控制要求也更高</p><p>早期，固态硬盘的浮栅晶体管是平铺在晶圆上的，平面结构很浪费空间，为了提高数据密度，设计出了可以垂直叠放的浮栅晶体管，因此现在固态硬盘的颗粒都成为VNAND（Vertical）</p><p>由大量浮栅晶体管组成的长方体成为Block块，其中一面中一行称为Page页，通过地址解码器+位线解码器来选中页Page，因此硬盘读取的最小单位就是页Page</p><p>DRAM作用：</p><ul><li>存储FTL表信息，用于加速主控查找数据的具体位置</li><li>缓解写放大：固态硬盘最小擦除单位是块，最小写入单位是页，因此当所有页都占满时，就需要将不足一页的数据进行合并，然后擦除块在进行写入，这会加速硬盘的寿命磨损，因此主控会在写入数据时先将数据写入DRAM中，等存满一页后再写入</li></ul><p>SLC Cache：当向硬盘持续写入数据时，会发现前一段时间写入速度较快（缓内速度），然后速度会变慢（缓外速度）</p><p>SLC的浮栅晶体管因为只需要维持两种状态，因此擦除或写入电子只需要极高或极低两种电压，相较于MLC或TLC，不需要精确控制电压，因此速度会更快，并且由于SLC只能写入1Bit，因此多Bit写入时所有Bit都是并行的，而MLC或TLC至少有2个或3个Bit是必须串行写入的，毫无疑问SLC速度会更快</p><p>对于一个浮栅晶体管而言，其是SLC还是TLC完全由主控的读写策略决定，因此主控可以将NAND中一部分浮栅晶体管模拟成SLC（SLC Cache），在写入数据时先将数据写入模拟成SLC的部分，然后再把这部分缓存写入TLC中，但因为SLC Cache是需要占用原来的TLC空间的，随着硬盘内数据的增加，SLC Cache的空间就会减少（并且如果把整个硬盘都模拟成SLC，那么硬盘的可用容量就会缩减成1/3），因此随着写入量的增加写入速度就会变慢</p><p>绝大多数情况下，都很少会进行超出SLC Cache范围之外的数据写入，因此用到的往往都是SLC的真实写入性能</p><p>由于SLC能存储的Bit数只有TLC的1/3，因此SLC Cache的存在无形会提高擦写次数，有些可以通过配置独立SLC区域，来避免小文件的写放大问题</p></div></div><div class=container><nav class="flex container suggested"><a rel=prev href=/posts/sunriches/%E5%85%A8%E7%90%83%E5%A4%A7%E5%8D%B0%E9%92%9E%E5%BF%85%E7%84%B6%E5%AF%BC%E8%87%B4%E7%9A%84%E4%B8%89%E4%B8%AA%E7%BB%93%E6%9E%9C/ title="Previous post (older)"><span>Previous</span>
全球大印钞，必然导致的三个结果！</a>
<a rel=next href=/posts/%E7%A1%AC%E4%BB%B6%E8%8C%B6%E8%B0%88/%E7%A1%AC%E4%BB%B6%E7%A7%91%E6%99%AE%E5%85%A8%E7%BD%91%E6%9C%80%E8%AF%A6%E7%BB%86%E6%98%93%E6%87%82%E7%9A%84g-sync-freesync-%E5%9E%82%E7%9B%B4%E5%90%8C%E6%AD%A5%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E7%A7%91%E6%99%AE/ title="Next post (newer)"><span>Next</span>
【硬件科普】全网最详细易懂的G Sync Freesync 垂直同步工作原理科普</a></nav></div><div class=container></div></main></main><footer class="footer flex"><section class=container><nav class=footer-links></nav></section><script defer src=/ts/features.c81551cd4dbef120af278f16966a41142c02be9ff5d6a669be09820fbf047456.js data-enable-footnotes=true></script></footer></body></html>